(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[229],{94309:function(e,t,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/home",function(){return l(1158)}])},4638:function(e,t,l){"use strict";var r=l(85893),a=l(67294),n=l(11355),s=l(18968),o=l(66180),i=l(44319);let c=e=>{let{className:t,classWrap:l,classOverlay:c,classButtonClose:d,visible:m,onClose:u,initialFocus:h,children:p,video:g,noMax:x}=e,f=e=>{e.stopPropagation()};return(0,r.jsx)(n.u,{show:m,as:a.Fragment,children:(0,r.jsxs)(s.V,{initialFocus:h,className:"fixed inset-0  z-50 flex p-6 overflow-auto scroll-smooth md:px-4 ".concat(t),onClose:u,children:[(0,r.jsx)(n.u.Child,{as:a.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,r.jsx)("div",{className:"fixed inset-0 ".concat(g?"bg-n-7/95":"bg-n-7/75 dark:bg-n-6/90"," ").concat(c),"aria-hidden":"true"})}),(0,r.jsx)(n.u.Child,{as:a.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 ".concat(!g&&"scale-95"),enterTo:"opacity-100 ".concat(!g&&"scale-100"),leave:"ease-in duration-200",leaveFrom:"opacity-100 ".concat(!g&&"scale-100"),leaveTo:"opacity-0 ".concat(!g&&"scale-95"),children:(0,r.jsxs)(s.V.Panel,{className:(0,o.m)("relative z-10  w-full m-auto bg-n-1 rounded-3xl dark:bg-n-7 ".concat(g&&"static max-w-[64rem] aspect-video rounded-[1.25rem] bg-n-7 overflow-hidden shadow-[0_2.5rem_8rem_rgba(0,0,0,0.5)]"," ").concat(l),"".concat(x?"":"max-w-[65rem] !important")),onClick:f,children:[p,(0,r.jsx)("button",{className:(0,o.m)("text-0 fill-n-7 hover:fill-primary-1 ".concat(g&&"absolute top-6 right-6 w-10 h-10 bg-n-1 rounded-full"," ").concat(d)),onClick:u,children:(0,r.jsx)(i.Z,{className:"fill-inherit transition-colors",name:"close"})})]})})]})})};t.Z=c},1158:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return em}});var r=l(85893),a=l(67294),n=l(55281),s=l(26565),o=l(90214),i=l(20947),c=l(9473),d=l(7938),m=l(65880),u=l(41478),h=l(62161),p=l(67556),g=l(23330),x=l(84913),f=l(96486),v=l.n(f),b=l(56726),w=l(4638),y=l(34546),j=l(31889),_=l(1852),N=l(4869);let k=(e,t)=>{let l=(0,a.useRef)(null),r=(0,c.v9)(e=>e.chat.chatStatus),[n,s]=(0,a.useState)(!1),o=(0,c.I0)();l.current=r,(0,a.useEffect)(()=>{let a=(e,t)=>{"new_chat"!=l.current&&o((0,h.VH)({id:e,title:t}))};if(t.id&&t.newItem&&!n){console.log("开始生成标题"),s(!0);let l=async()=>{try{let l=await(0,N.LK)(t.id);if(l.success){let{title:t,topic_id:r}=l.data;console.log(e,"historyList");let n=JSON.parse(JSON.stringify(e));n[0].title=t,n[0].newItem=!0,a(r,t),o((0,h.vK)(n))}}catch(e){console.error("Error in generating title:",e)}};l()}else"new_chat"==r&&s(!1)},[r,o,e,t,n])},S=()=>{let[e,t]=(0,a.useState)([]),l=(0,a.useRef)(!1),r=(0,c.I0)(),{modelData:n,userSelectionModel:s}=(0,c.v9)(e=>e.model);return(0,a.useEffect)(()=>{let e=async()=>{try{let e=await(0,N.Eu)();if(e.success){let l=e.data;if(t(l),l.length>0){if(s){let e=l.find(e=>e.model_id===n.model_id);r((0,p.$V)(!0)),r((0,p.g)(e||l[0]))}else r((0,p.$V)(!0)),r((0,p.g)(l[0]));r((0,p.Pm)(l))}}}catch(e){console.log(e,"error")}};l.current||(l.current=!0,e())},[]),{models:e}};var C=l(50733);let E=e=>{let{driverRef:t,jsonTips:l,json:r,isMobile:n,browserLanguage:s,isModelDialogOpen:o}=e,{visibleSidebar:i,visibleRightSidebar:c,setVisibleRightSidebar:d,setRightHistoryTips:u}=(0,a.useContext)(m.p),h="CHAT_TIPS";(0,a.useEffect)(()=>{let e=(0,C.bh)(h);if(l&&"ok"!=e&&(!n||+e>1&&n||c)){let a=()=>{(0,C.PQ)(h,"ok"),setTimeout(()=>{u(1),u(2)},100)},i=(0,C.zm)({steps:[{element:"#AI_Chat",popover:{title:l.chat_desc.title[s],description:l.chat_desc.description[s]}},{element:"#PRICE",popover:{title:l.price.title[s],description:l.price.description[s]}},{element:"#SelectModel",popover:{title:l.selectModel.title[s],description:l.selectModel.description[s]}},{element:"#SelectPlugins",popover:{title:l.selectPlugin.title[s],description:l.selectPlugin.description[s]}},{element:"#CHAT_EXP",popover:{title:l.app_desc.title[s],description:l.app_desc.description[s]}},{element:"#INPUT",popover:{title:l.chat_input.title[s],description:l.chat_input.description[s]}}],onPrev(){1==i.getState().activeIndex&&n&&d(!0),(0,C.PQ)(h,i.getState().activeIndex-1)},onNext(){1==i.getState().activeIndex&&n&&d(!1),(0,C.PQ)(h,i.getState().activeIndex)},onComplete(){a()}});t.current=i,r&&!o&&(1==+e&&n&&c||i.drive(e?+e:0))}},[r,o,u,i,c,l,s,n,d,t])},I=(e,t)=>{let[l,r]=(0,a.useState)([]),n=(0,c.I0)();return(0,a.useEffect)(()=>{let l=async e=>{try{let l=await(0,N.uv)(e);if(l.success){let e=l.data;r(e.conv_tree),n((0,h.fb)(e)),t&&t(),console.log("%c resultData 写入当前会话的聊天信息","color: #4CAF50; font-weight: bold")}}catch(e){console.error(e,"error")}};e.id&&2==e.newChat&&(console.log("%c resultData 选中当前历史记录->写入选中数据->发起当前数据ID请求聊天信息","color: #4CAF50; font-weight: bold"),l(e.id))},[n,e]),{conv_tree:l,setConvTree:r}};var T=l(94055),P=l(9581),A=l(44319),M=l(11119),L=l(82891);let O=a.forwardRef(function({title:e,titleId:t,...l},r){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":t},l),e?a.createElement("title",{id:t},e):null,a.createElement("path",{d:"M11.25 5.337c0-.355-.186-.676-.401-.959a1.647 1.647 0 01-.349-1.003c0-1.036 1.007-1.875 2.25-1.875S15 2.34 15 3.375c0 .369-.128.713-.349 1.003-.215.283-.401.604-.401.959 0 .332.278.598.61.578 1.91-.114 3.79-.342 5.632-.676a.75.75 0 01.878.645 49.17 49.17 0 01.376 5.452.657.657 0 01-.66.664c-.354 0-.675-.186-.958-.401a1.647 1.647 0 00-1.003-.349c-1.035 0-1.875 1.007-1.875 2.25s.84 2.25 1.875 2.25c.369 0 .713-.128 1.003-.349.283-.215.604-.401.959-.401.31 0 .557.262.534.571a48.774 48.774 0 01-.595 4.845.75.75 0 01-.61.61c-1.82.317-3.673.533-5.555.642a.58.58 0 01-.611-.581c0-.355.186-.676.401-.959.221-.29.349-.634.349-1.003 0-1.035-1.007-1.875-2.25-1.875s-2.25.84-2.25 1.875c0 .369.128.713.349 1.003.215.283.401.604.401.959a.641.641 0 01-.658.643 49.118 49.118 0 01-4.708-.36.75.75 0 01-.645-.878c.293-1.614.504-3.257.629-4.924A.53.53 0 005.337 15c-.355 0-.676.186-.959.401-.29.221-.634.349-1.003.349-1.036 0-1.875-1.007-1.875-2.25s.84-2.25 1.875-2.25c.369 0 .713.128 1.003.349.283.215.604.401.959.401a.656.656 0 00.659-.663 47.703 47.703 0 00-.31-4.82.75.75 0 01.83-.832c1.343.155 2.703.254 4.077.294a.64.64 0 00.657-.642z"}))});var D=l(57349);let Z=a.forwardRef(function({title:e,titleId:t,...l},r){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":t},l),e?a.createElement("title",{id:t},e):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12h15m0 0l-6.75-6.75M19.5 12l-6.75 6.75"}))});var H=l(9892);let R=e=>{let{className:t,checkbox:l,value:a,onChange:n,onHover:s,reverse:o}=e;return(0,r.jsxs)("label",{className:"transition-all group relative flex items-start select-none cursor-pointer tap-highlight-color ".concat(o&&"flex-row-reverse"," ").concat(t," first:rounded-t-xl ").concat(l.tips?"bg-red-200 dark:bg-red-200 ":""),onMouseOver:()=>s(!0),onMouseOut:()=>s(!1),children:[(0,r.jsx)("input",{className:"absolute top-0 left-0 opacity-0 invisible",type:"checkbox",value:a,onChange:n,checked:a}),(0,r.jsx)("span",{className:"relative flex justify-center items-center shrink-0 w-6 h-6 rounded border-2 border-n-3 transition-colors  dark:border-n-5 ".concat(a?"bg-primary-1 border-primary-1":"bg-transparent"),children:(0,r.jsx)(A.Z,{className:"w-4.5 h-4.5 fill-n-1 transition-opacity ".concat(a?"opacity-100":"opacity-0"),name:"check"})}),(0,r.jsxs)("div",{className:"".concat(o?"mr-auto pr-3":"pl-3"," flex items-center"),children:[l.icon&&(0,r.jsx)("div",{className:"w-6 h-6 border border-n-3 rounded-sm flex justify-center items-center mr-2",children:(0,r.jsx)(H.Z,{src:l.icon,alt:l.name,width:25,height:25})}),l.name&&(0,r.jsx)("span",{className:"base2 text-n-6 dark:text-n-3 ".concat(l.tips?"  text-red-800 dark:text-red-800":""),children:l.name})]})]})};l(6591);let z=a.forwardRef(function({title:e,titleId:t,...l},r){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":t},l),e?a.createElement("title",{id:t},e):null,a.createElement("path",{fillRule:"evenodd",d:"M9 4.5a.75.75 0 01.721.544l.813 2.846a3.75 3.75 0 002.576 2.576l2.846.813a.75.75 0 010 1.442l-2.846.813a3.75 3.75 0 00-2.576 2.576l-.813 2.846a.75.75 0 01-1.442 0l-.813-2.846a3.75 3.75 0 00-2.576-2.576l-2.846-.813a.75.75 0 010-1.442l2.846-.813A3.75 3.75 0 007.466 7.89l.813-2.846A.75.75 0 019 4.5zM18 1.5a.75.75 0 01.728.568l.258 1.036c.236.94.97 1.674 1.91 1.91l1.036.258a.75.75 0 010 1.456l-1.036.258c-.94.236-1.674.97-1.91 1.91l-.258 1.036a.75.75 0 01-1.456 0l-.258-1.036a2.625 2.625 0 00-1.91-1.91l-1.036-.258a.75.75 0 010-1.456l1.036-.258a2.625 2.625 0 001.91-1.91l.258-1.036A.75.75 0 0118 1.5zM16.5 15a.75.75 0 01.712.513l.394 1.183c.15.447.5.799.948.948l1.183.395a.75.75 0 010 1.422l-1.183.395c-.447.15-.799.5-.948.948l-.395 1.183a.75.75 0 01-1.422 0l-.395-1.183a1.5 1.5 0 00-.948-.948l-1.183-.395a.75.75 0 010-1.422l1.183-.395c.447-.15.799-.5.948-.948l.395-1.183A.75.75 0 0116.5 15z",clipRule:"evenodd"}))}),F=e=>{let{setOpen:t,pluginsData:l,setPluginsData:a,setPluginsStatus:n}=e,s=e=>"Default"==e.name?(0,r.jsx)(z,{className:"h-4 w-4 max-[370px]:hidden ".concat(e.isChecked?"text-n-9":"text-gray-500")}):"Plugins"==e.name?(0,r.jsx)(O,{className:"h-4 w-4 max-[370px]:hidden ".concat(e.isChecked?"text-n-9":"text-gray-500")}):void 0;return(0,r.jsxs)("div",{className:"w-[265px] group/options flex flex-col group border border-n-3 rounded-xl h6 transition-all   dark:border-n-5 bg-white dark:bg-n-6 ",children:[(0,r.jsx)("div",{className:"px-5 flex gap-2.5 flex-col py-4 whitespace-pre-line text-sm sm:text-base",children:(0,r.jsx)("span",{className:"block dark:text-white text-gray-900",children:"Our most capable model, great for tasks that require creativity and advanced reasoning."})}),(0,r.jsx)("div",{role:"group",className:"max-h-[calc(100vh-300px)] overflow-auto text-sm border-n-3 dark:border-n-5",children:l.map(e=>(0,r.jsxs)("div",{className:"select-none outline-none group/option relative flex w-full items-center gap-2 px-5 py-3 pr-11 font-medium focus:bg-gray-50 focus:dark:bg-gray-700 text-gray-900 dark:text-gray-100 cursor-pointer hover:!bg-gray-100 dark:hover:!bg-gray-700  border-t border-n-3 dark:border-n-5",onClick:()=>{l.map(t=>{t.isChecked=!1,t.name==e.name&&(t.isChecked=!0,n(t.name))}),console.log(l,"pluginsData"),a(l),localStorage.setItem("PLUGINSDATA",JSON.stringify(l)),t(!1)},children:[s(e),(0,r.jsx)("span",{title:e.name,className:"truncate group-hover/option:text-gray-800 dark:group-hover/option:text-gray-100 text-gray-800 dark:text-gray-100",children:e.name}),(0,r.jsx)("span",{className:"absolute right-3 rounded-full p-1 text-blue-400",children:(0,r.jsx)(A.Z,{className:"w-4 h-4 ml-auto fill-primary-1 opacity-0 transition-opacity ".concat(e.isChecked&&"opacity-100"),name:"check-thin"})})]},e.name))})]})},Q=e=>(0,r.jsx)("div",{className:"flex gap-2",children:e.map(e=>(0,r.jsx)("div",{className:"relative",children:(0,r.jsx)("div",{className:"w-6 h-6 border border-n-3 rounded-sm flex justify-center items-center",children:e.icon&&(0,r.jsx)(H.Z,{src:e.icon,alt:e.name,width:25,height:25,title:e.name})})},e.id))}),V=()=>{let[e,t]=(0,a.useState)([]),l=(0,a.useRef)(!1);return(0,a.useEffect)(()=>{let e=async()=>{try{let e=await(0,N.H8)();if(e.success){let l=e.data;l.map(e=>e.isChecked=!1),t(l)}}catch(e){console.log(e,"error")}};l.current||(l.current=!0,e())},[]),{pluginsEnabled:e,setPluginsEnabled:t}};var U=l(86892);let G=()=>{let[e,t]=(0,a.useState)([]);return(0,U.Z)(()=>{let e=async()=>{try{let e=await(0,N.T4)();if(e.success){let l=e.data;t(l)}}catch(e){console.log(e,"error")}};e()}),{pluginsStore:e,setPluginsStore:t}};var q=l(81976);let J=e=>{let{id:t,query:l}=e,[r,n]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{let e=new ResizeObserver(e=>{for(let t of e){let e=t.target.offsetWidth;t.target.offsetHeight,e<l.w&&!r?(console.log("写入autoFill true"),n(!0)):e>l.w&&r&&(console.log("写入autoFill false"),n(!1))}}),a=document.querySelector(t);return a&&e.observe(a),()=>{e.disconnect()}},[r,t,l]),r},B=e=>{let{driverRef:t,jsonTips:l,browserLanguage:r,onNext:n}=e,s="PLUGINS_TIPS",o=(0,C.bh)(s);(0,a.useEffect)(()=>{if(l&&"ok"!=o)try{let e=(0,C.zm)({steps:[{element:"#pluginsSelect",popover:{title:l.pluginsSelect.title[r],description:l.pluginsSelect.description[r]}},{element:"#pluginStore",popover:{title:l.pluginsStore.title[r],description:l.pluginsStore.description[r]}}],onPrev(){(0,C.PQ)(s,e.getState().activeIndex-1)},onNext(){(0,C.PQ)(s,e.getState().activeIndex),n()},onComplete(){(0,C.PQ)(s,"ok")}});t.current=e,"ok"!=o&&e.drive(o?+o:0)}catch(e){}},[s,o,r,t,l])};var W=l(86501),$=l(43709),X=l(9177);let K=(0,a.lazy)(()=>Promise.resolve().then(l.bind(l,6591))),Y=e=>{let{btnCss:t,cStatus:l,rightDesc:n}=e,{model:{modelData:s},language:{browserLanguage:o}}=(0,c.v9)(e=>e),{pluginsEnabled:i,setPluginsEnabled:u}=V(),{pluginsStore:h,setPluginsStore:p}=G(),x=J({id:"#print-view",query:{w:767}}),[f,b]=(0,a.useState)(!1),[y,j]=(0,a.useState)(!1),[_,N]=(0,a.useState)(!1),[k,S]=(0,a.useState)(!1),[E,I]=(0,a.useState)(null),[T,P]=(0,a.useState)(null),A=(0,a.useRef)(null),[M,z]=(0,a.useState)(),{pluginsSelect:Y,setPluginsSelect:ee,pluginsStatus:et,setPluginsStatus:el}=(0,a.useContext)(m.p),er=async()=>{await(0,C.hc)(e=>{P(e)})};B({jsonTips:T,driverRef:A,browserLanguage:o,onNext(){j(!0)}}),(0,a.useEffect)(()=>{if("Plugins"==et){let e=(0,C.bh)("PLUGINS_TIPS");try{"ok"==e||s.free||(er(),console.log(e,"1111"),j(!0))}catch(e){console.error(e)}}},[et,s]),(0,U.Z)(()=>{let e=localStorage.getItem("PLUGINSDATA");try{if(Array.isArray(JSON.parse(e))){let t=JSON.parse(e);z(t),el(t.filter(e=>e.isChecked)[0].name)}else z([{name:"Default",isChecked:!0},{name:"Plugins",isChecked:!1}])}catch(e){console.error(e,"error")}}),(0,a.useEffect)(()=>{let e=localStorage.getItem("PLUGINS_SELECT_DATA");if(i.length>0){let t=JSON.parse(e);if(Array.isArray(t)){let e=(0,g.GW)(t,i);ee(e)}}},[i]),(0,q.Z)(["pluginsSelect","pluginsEnabled","notify"],()=>{j(!1)});let ea=e=>{b(e)};return(0,r.jsxs)(r.Fragment,{children:[("new_chat"==l||"Default"==et)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(L.default,{placement:"bottom",dropdownRender:e=>F({setOpen:b,pluginsData:M,setPluginsData:z,setPluginsStatus:el}),overlayStyle:{zIndex:20},onOpenChange:ea,open:f,children:(0,r.jsxs)("button",{id:"SelectPlugins",className:"".concat(t||"btn-dark btn-medium"," md:mr-0"),children:["new_chat"==l&&(0,r.jsx)(O,{className:"inline-block w-[1rem!important] h-[1rem!important] fill-n-4 transition-colors ml-[0!important]"}),(0,g.VQ)("CHAT_SELECT_PLUGINS",o)]})}),(0,r.jsx)("br",{})]}),"Plugins"==et&&(0,r.jsxs)("div",{className:"transition-all mx-[0!important] flex justify-center relative ".concat(t?"ml-[0!important]":"mt-5"," ").concat("new_chat"!=l?"ml-[0.75rem!important] md:ml-[0!important] mt-0":"mt-5"),children:[(0,r.jsxs)("div",{id:"pluginsSelect",className:"max-w-[265px] h-[36px] flex items-center px-3 py-2 border border-gray-200 dark:border-n-5 rounded-lg text-sm font-semibold ".concat(s.free?"":"cursor-pointer"),onClick:()=>{if(s.free)return!1;j(!y),u((0,g.xZ)(Y,i))},children:[0==Y.length||s.free?s.free?(0,g.VQ)("CHAT_PLUGINS_SELECT_TIPS_FREE",o):(0,g.VQ)("CHAT_PLUGINS_SELECT_TIPS_NO",o):Q(Y),!s.free&&(0,r.jsx)(D.Z,{className:"ml-1 w-5 h-5 fill-gray-400 print-hide"})]}),y&&(0,r.jsxs)("div",{id:"pluginsEnabled",className:"w-[340px] md:w-[360px] group/options flex flex-col group border border-n-3 rounded-xl h6 transition-all  dark:border-n-5 bg-white dark:bg-n-6 absolute top-[47px] md:top-[45px]  z-10 ",children:[i.length>=3&&(0,r.jsxs)("div",{className:"flex h-8 flex-shrink-0 items-center justify-center border-b border-gray-200 bg-gray-100 text-xs text-gray-800 dark:border-n-5 dark:bg-n-6 dark:text-white transition-colors duration-300 rounded-t-xl ".concat(_?"bg-red-200 dark:bg-red-200 text-red-800 dark:text-red-800":""),children:[Y.length,"/3 Enabled"]}),(0,r.jsx)("div",{className:"overflow-auto max-h-[205px]",children:i.map((e,t)=>(0,r.jsx)(R,{className:"first:border-t-0 px-5 py-3 border-t border-n-3 dark:border-n-5",checkbox:e,value:e.isChecked,onChange:()=>{let l=v().cloneDeep(Y),a=l.filter(e=>e.dedicated&&e.isChecked);if(console.log(a,"dedicated"),a.length>0&&!e.dedicated){let e=v().cloneDeep(i),t=e.findIndex(e=>e.dedicated&&e.isChecked);e[t].tips=!0,u(e),setTimeout(()=>{let e=v().cloneDeep(i);e[t].tips=!1,u(e)},800),(0,X.Z)({content:(0,g.VQ)("CHAT_SELECT_DEDICATED_USE_TIPS",o),iconCircle:!0,duration:5e3});return}if(e.dedicated&&!e.isChecked)(0,W.Am)(e=>(0,r.jsxs)($.Z,{className:"md:flex-col md:items-center md:px-10",iconCircle:!0,children:[(0,r.jsx)("div",{className:"ml-3 mr-6 h6 md:mx-0 md:my-2",children:(0,g.VQ)("CHAT_SELECT_DEDICATED_TIPS",o)}),(0,r.jsxs)("div",{className:"flex justify-center",children:[(0,r.jsx)("button",{className:"btn-stroke-light btn-medium md:min-w-[6rem]",onClick:()=>W.Am.dismiss(e.id),children:"Cancel"}),(0,r.jsx)("button",{className:"btn-blue btn-medium ml-3 md:min-w-[6rem]",onClick:()=>{W.Am.dismiss(e.id);try{let e=v().cloneDeep(i);e.map(e=>{e.isChecked=!1}),e[t].isChecked=!0;let l=e.filter(e=>e.isChecked);ee(l),u(e),localStorage.setItem("PLUGINS_SELECT_DATA",JSON.stringify(l))}catch(e){console.error("删除历史记录失败: ",e)}},children:"Yes"})]})]}),{duration:1e4});else{let e=v().cloneDeep(i);e[t].isChecked=!e[t].isChecked;let l=e.filter(e=>e.isChecked);if(l.length>3)return N(!0),setTimeout(()=>{N(!1)},800),!1;ee(l),u(e),localStorage.setItem("PLUGINS_SELECT_DATA",JSON.stringify(l))}},onHover:t=>{if(!t){I(null);return}I(e)},reverse:!0},e.id))}),(0,r.jsxs)("div",{id:"pluginStore",className:"group relative flex justify-between px-5 py-3 cursor-pointer select-none items-center overflow-hidden  pl-5 text-gray-900 hover:!bg-gray-100 dark:hover:!bg-gray-700 ".concat(0!=i.length&&"border-t border-n-3 dark:border-n-5 rounded-b-xl"),onClick:()=>{S(!0),(0,C.PQ)("PLUGINS_TIPS","ok"),A.current&&A.current.destroy()},children:[(0,r.jsx)("div",{className:"base2 text-n-6 dark:text-n-3",children:(0,g.VQ)("CHAT_PLUGINS_STORE",o)}),(0,r.jsx)(Z,{className:" inset-y-0 right-0 flex items-center text-gray-800 dark:text-gray-100 w-5 h-5"})]}),E&&!x&&(0,r.jsx)("div",{className:"absolute top-0 bottom-0 z-10 ".concat(n?"left-full":"right-full"," "),children:(0,r.jsxs)("div",{className:"  p-4 w-[240px] min-h-[140px] group/options flex flex-col group border border-n-3 rounded-xl h6 transition-all  dark:border-n-5 bg-white dark:bg-n-6 ",children:[(0,r.jsx)("div",{className:"flex items-center justify-center w-18 h-18  border border-n-3 h6 transition-all bg-white relative",children:E.icon&&(0,r.jsx)(H.Z,{src:E.icon,alt:E.name,style:{objectFit:"contain"},width:72,height:72})}),(0,r.jsxs)("div",{className:"flex flex-col items-start mt-1",children:[(0,r.jsx)("p",{className:"text-base text text-left py-1",children:E.name}),(0,r.jsxs)("p",{className:"text-xs text-left pb-1",children:["Price:  ","0"!=E.price?"$".concat(E.price,"/use"):"free"]}),(0,r.jsx)("p",{className:"text-xs text-left",children:E.desc})]})]})})]})]}),(0,r.jsx)(w.Z,{className:"md:!p-0",classWrap:"w-[86vw] md:min-h-screen-ios md:rounded-none 2xl:h-[44rem] md:h-full md:w-full",classButtonClose:"block absolute top-5 right-5 dark:fill-n-4",classOverlay:"md:bg-n-1",visible:k,onClose:()=>S(!1),noMax:!0,children:(0,r.jsx)(a.Suspense,{fallback:(0,r.jsx)(d.Z,{}),children:(0,r.jsx)(K,{pluginsStore:h,setPluginsStore:p,onEnabled:(e,t)=>{let l=[...Y],r=l.filter(e=>e.id!=t);ee(r),localStorage.setItem("PLUGINS_SELECT_DATA",JSON.stringify(r)),u((0,g.xZ)(Y,e))},onClose:e=>{}})})})]})},ee=e=>{let{CHAT_TIPS:t,driverRef:l,json:a,setIsModelDialogOpen:n}=e,{model:{modelData:s,userSelectionModel:o},language:{browserLanguage:i}}=(0,c.v9)(e=>e),d=e=>{if(e){let t=[];return Object.keys(e).map(l=>{t.push((0,r.jsx)("p",{dangerouslySetInnerHTML:{__html:"".concat(l,": ").concat(e[l])}},l))}),t}};return(0,r.jsxs)("div",{className:"absolute w-[90%] flex justify-center items-center flex-col ",style:{top:0,left:"50%",height:"calc(100% - 4.5rem)",marginLeft:"-45%"},children:[(0,r.jsxs)("div",{className:"mb-5 text-center w-full",children:[(0,r.jsx)("div",{className:"h3 leading-[4rem] 2xl:mb-2 2xl:h4 flex items-center relative h-12 ",children:(0,r.jsx)("div",{style:{position:"absolute",left:"50%",width:"100%",transform:"translateX(var(--offset))"},children:(0,r.jsx)("div",{className:"flex items-center justify-center ",children:(0,r.jsx)(T.default,{placement:"top",overlayClassName:"oc-300 sm:oc-none",title:()=>(0,r.jsxs)("div",{className:"p-2",children:[s.model_name,d(null==s?void 0:s.meta)]}),children:(0,r.jsxs)("div",{className:"flex items-center justify-center ",id:"PRICE",children:[o?s.model_name:"Chat",(0,r.jsx)("div",{className:"ml-1",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"w-6 h-6 text-gray-500",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"})})})]})})})})}),(0,r.jsx)("div",{className:"body1 text-n-4 2xl:bodyS mt-2",children:a&&a.CHAT_TITTLE[i]}),(0,r.jsxs)("div",{className:"space-x-3",children:[(0,r.jsxs)("button",{id:"SelectModel",className:"btn-dark btn-medium  mt-2",onClick:()=>{let e=(0,C.bh)(t);"ok"!=e&&2==+e&&(l.current&&l.current.destroy(),(0,C.PQ)(t,3)),n(!0)},children:[(0,r.jsx)(A.Z,{className:"inline-block w-[1rem!important] h-[1rem!important] fill-n-4 transition-colors ml-[0!important]",name:"container"}),M.CHAT_SELECT_MODEL[i]||M.CHAT_SELECT_MODEL.en]}),(0,r.jsx)(Y,{cStatus:"new_chat",btnCss:"btn-dark btn-medium"})]})]}),(0,r.jsx)("div",{id:"CHAT_EXP",children:a&&(0,r.jsx)(P.Z,{page:"chat",json:a,onClick:()=>{let e=(0,C.bh)(t);"ok"!=e&&(l.current.destroy(),(0,C.PQ)(t,4))}})})]})};var et=l(68709),el=l(19120),er=l(14328),ea=l(98354);let en=e=>{let{modelShow:t,conv_tree:l,cStatus:n,setIsModelDialogOpen:s}=e,[o,i]=(0,a.useState)(!1),[d,u]=(0,a.useState)(!1),{config:{mode:h},model:{modelData:p},language:{browserLanguage:x}}=(0,c.v9)(e=>e),{selectChatHistory:f}=(0,c.v9)(e=>e.chat),{pluginsStatus:v}=(0,a.useContext)(m.p),b=()=>(0,r.jsxs)("div",{className:" flex items-center flex-1",children:[p&&p.icon&&(0,r.jsx)("img",{src:p.icon,alt:"logo",className:"w-7 h-7 mr-2 rounded-full"}),(0,r.jsx)("div",{id:"model_name",children:p&&p.model_name})]}),w=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return(0,r.jsxs)("div",{className:"flex items-center cursor-pointer",style:{fontWeight:"600",fontSize:"1.125rem"},onClick:()=>{i(!1),s(!0)},onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),children:[e&&b(),t&&(0,r.jsx)(T.default,{placement:"bottom",title:(0,g.VQ)("HOME_CENTER_TOP_SWITCHDESC",x),open:o,children:(0,r.jsx)("button",{className:"btn-dark btn-small ml-3 print-hide",children:(0,g.VQ)("HOME_CENTER_TOP_SWITCHBTN",x)})})]})},y=()=>(0,r.jsx)("button",{className:"group w-8 h-8 mr-6 md:ml-3 md:mr-0 print-hide",onClick:()=>u(!0),children:(0,r.jsx)(A.Z,{className:"fill-n-4 transition-colors group-hover:fill-primary-1",name:"share"})}),j=(0,_.useMediaQuery)({query:"(max-width: 765px)"});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:" relative",children:[(0,r.jsxs)("div",{className:"relative z-10 flex items-center min-h-[4.5rem] px-10 py-3 md:min-h-[3.5rem] md:py-0 lg:pr-20 md:pl-5 md:pr-18 2xl:px-6 border-b border-n-3 shadow-[0_0.75rem_2.5rem_-0.75rem_rgba(0,0,0,0.06)] dark:border-n-5 dark:shadow-[0_0.75rem_2.5rem_-0.75rem_rgba(0,0,0,0.15)] bg-white dark:bg-n-6 rounded-t-[1.25rem]",children:[(0,r.jsxs)("div",{className:"mr-auto flex",id:"chat_title",children:[j&&(0,r.jsx)("div",{className:"md:h6",style:{lineHeight:1.2},children:f.title||"New Chat"}),!j&&"chat"==h&&(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[w(),(0,r.jsx)(Y,{cStatus:n,rightDesc:!0,btnCss:"btn-dark btn-small ml-3 print-hide"})]})]}),(0,r.jsx)("div",{className:"flex relative items-center ml-3",children:!j&&f.id&&y()})]}),j&&"chat"==h&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("header",{className:"w-full h-[3.35rem] pl-5 pr-6 flex items-center justify-between transition duration-300 ease-in-out transition-width  border-b border-n-3 shadow-[0_0.75rem_2.5rem_-0.75rem_rgba(0,0,0,0.06)] bg-white dark:border-n-5 dark:shadow-[0_0.75rem_2.5rem_-0.75rem_rgba(0,0,0,0.15)] dark:bg-n-6 absolute left-0 right-0 top-[3.35rem] z-5 print-hide",style:{transform:"translateY(".concat(t?"0":"-100%",")")},children:[w(),(0,r.jsx)("div",{className:"flex relative items-center ml-6",children:f.id&&y()})]}),(0,r.jsx)("header",{className:"w-full h-[3.35rem] pl-5 pr-5 flex items-center  transition duration-300 ease-in-out transition-width  border-b border-n-3 shadow-[0_0.75rem_2.5rem_-0.75rem_rgba(0,0,0,0.06)] bg-white dark:border-n-5 dark:shadow-[0_0.75rem_2.5rem_-0.75rem_rgba(0,0,0,0.15)] dark:bg-n-6 absolute left-0 right-0 top-[6.7rem] z-5 print-hide justify-center",style:{transform:"translateY(".concat(t?"0":"-200%",")")},children:(0,r.jsx)(Y,{cStatus:n,rightDesc:!0,btnCss:"btn-dark btn-small mr-3 print-hide"})})]})]}),(0,r.jsx)(ea.Z,{visible:d,onClose:()=>u(!1),tid:f.id,conv_tree:l,setVisibleModal:u})]})};var es=l(51900);let eo=(0,a.lazy)(()=>l.e(758).then(l.bind(l,40758))),ei=()=>{let[e,t]=(0,a.useState)(!1),[l,n]=(0,a.useState)(!1),[s,o]=(0,a.useState)(!0),{statusDataReset:i,setStatusDataReset:f,setRightRechargeTips:N,pluginsSelect:C,pluginsStatus:T,filesList:P,setFileList:A}=(0,a.useContext)(m.p),M=(0,a.useRef)(null),[L,O]=(0,a.useState)([]),[D,Z]=(0,a.useState)(1),[H,R]=(0,a.useState)(1),[z,F]=(0,a.useState)(),Q=(0,c.I0)(),{config:{mode:V},model:{modelData:U,chatModelParams:G},language:{browserLanguage:q}}=(0,c.v9)(e=>e),{userInfo:{globalOrgId:J}}=(0,c.v9)(e=>e),{chatStatus:B,chatAboutInfo:W,historyList:$,selectChatHistory:X}=(0,c.v9)(e=>e.chat),K=(0,_.useMediaQuery)({query:"(max-width: 765px)"}),{models:Y}=S(),{conv_tree:ea,setConvTree:ei}=I(X,()=>{Z(D+1),R(H+1),console.log("setStatusDataReset false"),f(!1)});k($,X);let{json:ec,jsonTips:ed}=(0,et.Z)();E({json:ec,jsonTips:ed,isMobile:K,driverRef:M,browserLanguage:q,isModelDialogOpen:e});let em=async e=>{let{message:t,type:r,attachments:a,save:s,parentId:o,regenerate:i}=e;if(M.current&&M.current.destroy(),"new_chat"==B&&f(!1),"responding"==B||"sending"==B)return!1;if(Z(D+1),R(H+1),""!==t.trim()||i||P.length>0){let e=G.find(e=>e.model_id===U.model_id),r={};(0,g.hu)(null==e?void 0:e.paramsAction,"模型不存在"),(null==e?void 0:e.paramsAction)&&e.paramsAction.map(e=>{r[e.name]=e.default});let c=null,d=null,m=null,p=()=>{m=null,Q((0,h.Hr)({page:V,status:"dialogue"})),z&&z.abort()};try{(0,g.hu)(e,"model_params 没有找到默认模型或者用户所选择的模型"),console.log(e,"model_params"),console.log(W,"chatAboutInfo"),Q((0,h.Hr)({page:V,status:"sending"}));let f=P.filter(e=>"done"==e.status),{cid1:b,cid2:w,Obj:y}=(0,es.i)({message:t,attachments:a||f,save:s,parentId:o,regenerate:i,conv_tree:ea,setConvTree:ei,model:e.model_id}),j=await(0,er.ve)(y);if("new_chat"==B){console.log(e,"paramsData"),Q((0,h.VH)({title:"New Chat",id:"",newItem:!1}));let t=v().cloneDeep(W);t.topic={format_version:2,id:"",model:e.model_id,title:"",params:{},params_def:[]},console.log(t,"caInfo"),Q((0,h.fb)({...t}))}let _=v().once(()=>{console.log("这个函数只会执行一次调用！"),console.log(B,"chatStatus"),Q((0,h.Hr)({page:V,status:"responding"}))});console.log("%c 写入当前会话的聊天信息和占位数据","color: #4CAF50; font-weight: bold");let k=[...C].filter(e=>null!==e.id&&""!==e.id).map(e=>e.id),S=(a||f).map(e=>"string"==typeof e?e:e.url);console.log(S,"attaUrl");let E=[],I=!1,M=async()=>{for(I=!0;E.length>0;){let e=E.shift();try{let t=e.event;switch(console.log(t,"eventName"),t){case"onOpen":{let{detail:t,errcode:l}=e.data;j=await(0,er.ve)({editInfo:{id:b,errcode:l},changeItem:{id:w,loading:!1,contentData:{type:1,args:{content:(0,g.Pq)(l,t)},textMerge:!0},errcode:l},conv_tree:j.lastTree,setConvTree:ei}),console.log(j,"lastCurd"),p(),n(!0),O(j.lastTree),console.log("setThatLastErr设置为true了"),1601==l&&N(1+Math.random());break}case"onError":{let{detail:t,errcode:l}=e.data;j=await(0,er.ve)({errItem:{loading:!1,contentData:{type:1,args:{content:(0,g.Pq)(l,t)},textMerge:!0},errcode:l},conv_tree:j.lastTree,setConvTree:ei}),O(j.lastTree),p();break}case"meta":console.log(e.data,"meta");try{if(d=JSON.parse(e.data),console.log(d,"data meta"),d&&d.tid){let e={changeItem:{id:w,resetId:d.cid2},conv_tree:j.lastTree,setConvTree:ei};if(j=i?await(0,er.ve)(e):await(0,er.ve)({editInfo:{id:b,resetId:d.cid1},...e}),O(j.lastTree),"new_chat"==B){let e={title:"New Chat",id:d.tid,newItem:!0},t=v().cloneDeep($);t.unshift(e),Q((0,h.vK)(t)),Q((0,h.VH)(e))}}}catch(e){console.error("Failed to parse event data:",e);return}break;case"func_call":console.log(d,"func_req log");try{let t=JSON.parse(e.data);console.log(t,"1111"),j=await(0,er.ve)({editInfo:{id:d.cid1,mod_result:null==c?void 0:c.q},changeItem:{id:d.cid2,loading:!1,contentData:{...t,func_call:!0},mod_result:null==c?void 0:c.a},conv_tree:j.lastTree,setConvTree:ei}),_()}catch(e){console.error(e,"err")}break;case"update":try{let t=JSON.parse(e.data);console.log(t.args.content,"updatedata"),m=t,console.log(1),j=await(0,er.ve)({editInfo:{id:d.cid1,mod_result:null==c?void 0:c.q},changeItem:{id:d.cid2,loading:!1,contentData:{...t,textMerge:!0},mod_result:null==c?void 0:c.a},conv_tree:j.lastTree,setConvTree:ei}),console.log(2),_()}catch(e){console.error("Failed to parse event data:",e);return}break;case"mod":c=JSON.parse(e.data),console.log(c,"先mod1");break;case"end":console.log("end"),j=await(0,er.ve)({editInfo:{id:d.cid1,mod_result:null==c?void 0:c.q},changeItem:{id:d.cid2,loading:!1,contentData:{...m,textMerge:!0},mod_result:null==c?void 0:c.a},conv_tree:j.lastTree,setConvTree:ei}),O(j.lastTree),p(),m=null;break;case"err":try{let t=e.data?JSON.parse(e.data):null;console.log(t,"errerrerr"),j=await(0,er.ve)({changeItem:{id:d.cid2,loading:!1,contentData:{type:1,args:{content:(0,g.Pq)(null==t?void 0:t.errcode,null==t?void 0:t.detail)},textMerge:!0},errcode:t&&(null==t?void 0:t.errcode)},conv_tree:j.lastTree,setConvTree:ei}),O(j.lastTree)}catch(e){console.log(e,"error")}p()}}catch(e){console.error("处理消息时出错：",e)}}I=!1};A([]);let L=(0,x.Z)({url:"/api/conversation?org_id=".concat(J,"&req_rand=").concat(Math.random()),body:JSON.stringify({text:t,model:e.model_id,functions:"Plugins"==T?k:null,attachments:S,model_params:r,topic_id:"dialogue"===B?X.id:null,parent_id:X.id?await(0,es.r)({last:j,save:s,parentId:o,conv_tree:ea,regenerate:i,thatLastErr:l}):null},(e,t)=>"string"==typeof t?t.replace(/\\\\/g,"\\"):t),headers:{"x-ai-model":e.model_id},onOpen:async e=>{console.log(e,"onOpen data"),e.success?e.success&&n(!1):(E.push({event:"onOpen",data:e.data}),I||M())},onMessage:async e=>{E.push(e),I||M()},onError:async e=>{console.log("对话发起失败或者其他原因",e);try{E.push({event:"onError",data:{errcode:9999,detail:"An error occurred. Either the engine you requested does not exist or there was another issue processing your request. If this issue persists please contact us through our help center at support@theb.ai."}}),I||M()}catch(e){console.error(e,"onError")}},onClose(){Q((0,u.yA)()),Z(D+1)},onFinally(){console.log("onFinally"),c=null,p()}});F(L)}catch(e){console.log(e,"errorerror"),p()}}else console.log("没发送")};return(0,a.useEffect)(()=>{("new_chat"===B||i)&&(console.log("新聊天肯定要把输入框放出来"),n(!1),ei([]),O([]),i&&f(!1)),("new_chat"===B||"dialogue"===B)&&z&&z.abort()},[i,B,ei,z]),(0,a.useEffect)(()=>{let e=async()=>{let e=await(0,er.f4)(L),t=await(0,er.D6)(L);console.log(e,"errParentId"),console.log(t,"lastItem"),null==e&&n(!1),t.errcode&&n(!0)};"dialogue"==B&&X.id&&L.length>0&&!i&&e()},[ea,L,B,X,i]),(0,r.jsxs)(r.Fragment,{children:[(X.id||ea.length>0)&&(0,r.jsx)(en,{conv_tree:ea,modelShow:s,cStatus:B,setIsModelDialogOpen:t}),(0,r.jsxs)(b.Z,{conv_tree:ea,refresh:D,refreshDialogue:H,cStatus:B,modelShow:s,setModelShow:o,children:[K&&(0,r.jsx)("header",{className:"w-full ".concat("Default"==T&&"new_chat"==B?"h-[3.35rem]":"h-[6.7rem]","  sticky top-0 print-hide")}),"new_chat"===B&&0==ea.length&&ec&&(0,r.jsx)(ee,{driverRef:M,CHAT_TIPS:"CHAT_TIPS",json:ec,setIsModelDialogOpen:t}),ea.length>0&&(0,r.jsx)(el.Z,{conv_tree:ea,setConvTree:ei,setLastTree:O,status:B,handleSendMessage:e=>{let{message:t,attachments:l,parentId:r,save:a}=e;em({message:t,attachments:l,parentId:r,save:a,type:1})}})]}),(0,r.jsxs)(j.Z,{handleSendMessage:e=>em({message:e,type:1}),setRefresh:e=>Z(e),refresh:D,status:B,thatLastErr:l,domId:"INPUT",children:["responding"===B&&z&&(0,r.jsx)(y.$,{stop:z,MODE:V,thatLastErr:l}),"dialogue"===B&&2==W.topic.format_version&&ea.length>0&&(0,r.jsx)(y.H,{thatLastErr:l,onClick:async()=>{let e=await(0,er.uF)(ea);e&&(Q((0,h.Hr)({page:V,status:"sending"})),em({message:e.content,attachments:e.attachments,regenerate:e.id,type:1}))}})]}),(0,r.jsx)(w.Z,{className:"md:!p-0",classWrap:"w-[86vw] md:min-h-screen-ios md:rounded-none 2xl:h-[44rem] md:h-full md:w-full",classButtonClose:"block absolute top-5 right-5 dark:fill-n-4",classOverlay:"md:bg-n-1",visible:e,onClose:()=>t(!1),noMax:!0,children:(0,r.jsx)(a.Suspense,{fallback:(0,r.jsx)(d.Z,{}),children:(0,r.jsx)(eo,{models:Y,onClose:e=>{Q((0,p.g)(e)),Q((0,p.$V)(!0)),t(!1)}})})})]})},ec=()=>{let[e,t]=(0,a.useState)(),[l,m]=(0,a.useState)(!0),p=(0,c.I0)();(0,i.Z)(),(0,U.Z)(()=>{p((0,u.PM)("chat")),p((0,h.VH)({title:"New Chat",id:"",newItem:!1}))});let{userInfo:g}=(0,c.v9)(e=>e);return(0,a.useEffect)(()=>{console.log(g,"userInfouserInfo");let e=g.meData;e&&(t(e),m(!1))},[g]),(0,o.Z)(),(0,r.jsxs)(r.Fragment,{children:[l&&(0,r.jsx)(d.Z,{}),e&&(0,r.jsx)(s.H,{children:(0,r.jsx)(n.Z,{rightSidebarMode:"chat",children:(0,r.jsx)(ei,{})})})]})},ed=()=>(0,r.jsx)(ec,{});var em=ed},6591:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return w}});var r=l(85893),a=l(67294),n=l(9473),s=l(43709),o=l(86501),i=l(25675),c=l.n(i),d=l(50733),m=l(86892);let u=e=>{let{driverRef:t,jsonTips:l,browserLanguage:r}=e,{config:{mode:s}}=(0,n.v9)(e=>e),o="PLUGINS_MODAL_TIPS",i=(0,d.bh)(o);(0,a.useEffect)(()=>{if(l&&"ok"!=i){let e=(0,d.zm)({steps:[{element:"#SelectModelView",popover:{title:l.selectPlugin.title[r],description:l.selectPlugin.description[r]}},{element:"#SelectModelButton",popover:{title:l.selectPluginButton.title[r],description:l.selectPluginButton.description[r]}}],onPrev(){(0,d.PQ)(o,e.getState().activeIndex-1)},onNext(){(0,d.PQ)(o,e.getState().activeIndex)},onComplete(){(0,d.PQ)(o,"ok")}});t.current=e,"ok"!=i&&e.drive(i?+i:0)}},[o,i,r,t,l,s])};var h=l(89552),p=l(628),g=l.n(p);let x=a.forwardRef(function({title:e,titleId:t,...l},r){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":t},l),e?a.createElement("title",{id:t},e):null,a.createElement("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm-1.72 6.97a.75.75 0 10-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 101.06 1.06L12 13.06l1.72 1.72a.75.75 0 101.06-1.06L13.06 12l1.72-1.72a.75.75 0 10-1.06-1.06L12 10.94l-1.72-1.72z",clipRule:"evenodd"}))}),f=a.forwardRef(function({title:e,titleId:t,...l},r){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:r,"aria-labelledby":t},l),e?a.createElement("title",{id:t},e):null,a.createElement("path",{fillRule:"evenodd",d:"M10.5 3.75a6 6 0 00-5.98 6.496A5.25 5.25 0 006.75 20.25H18a4.5 4.5 0 002.206-8.423 3.75 3.75 0 00-4.133-4.303A6.001 6.001 0 0010.5 3.75zm2.25 6a.75.75 0 00-1.5 0v4.94l-1.72-1.72a.75.75 0 00-1.06 1.06l3 3a.75.75 0 001.06 0l3-3a.75.75 0 10-1.06-1.06l-1.72 1.72V9.75z",clipRule:"evenodd"}))});var v=l(4869);let b=e=>{let{onClose:t,onEnabled:l,pluginsStore:i,setPluginsStore:p}=e,b=(0,a.useRef)(null),[w,y]=(0,a.useState)(null),{language:{browserLanguage:j}}=(0,n.v9)(e=>e),_=async()=>{await(0,d.hc)(e=>{y(e)})};u({jsonTips:w,driverRef:b,browserLanguage:j});let N="PLUGINS_MODAL_TIPS",k=(0,d.bh)(N);return(0,m.Z)(()=>{try{"ok"!=k&&_()}catch(e){console.error(e)}}),(0,r.jsxs)("div",{className:"w-full px-6 pt-3 lg:px-8 md:pt-6 md:pb-8 sm:max-h-max box-border overflow-hidden max-h-[44rem]",style:{height:"calc(100% - 2rem)"},children:[(0,r.jsx)("div",{className:"h6",children:"Plugin store"}),(0,r.jsx)("div",{className:"my-4 h-0.25 dark:border-n-5 -mx-4 md:mx-0  border-b border-gray-900/5  dark:border-transparent dark:bg-n-5/50"}),(0,r.jsx)("div",{className:"w-full  overflow-y-scroll h-[38.5rem] sm:h-full pb-4 scrollbar-test",children:(0,r.jsx)("ul",{role:"list",className:"grid grid-cols-4 gap-4 sm:grid-cols-1 xl:grid-cols-3 lg:grid-cols-2",children:i.length>0&&i.map((e,t)=>(0,r.jsxs)("li",{className:" rounded-xl border border-gray-200 dark:border-transparent dark:bg-n-5/50 overflow-hidden",id:0==t?"SelectModelView":"",children:[(0,r.jsxs)("div",{className:"flex items-center gap-x-4 border-b border-gray-900/5  dark:border-transparent dark:bg-n-5 p-3 relative",children:[(0,r.jsxs)("div",{style:{width:65,height:65},className:"flex items-center justify-center relative",children:[e.icon&&(0,r.jsx)(c(),{src:e.icon,title:e.name,alt:e.name,className:"rounded-lg",width:65,height:65}),e.free&&(0,r.jsx)("div",{className:"rounded-tl-lg rounded-br-md bg-n-9 absolute top-0 left-0 text-white px-1 text-xs",children:"free"})]}),(0,r.jsxs)("div",{className:"flex flex-col",style:{flex:1,minWidth:0},children:[(0,r.jsx)("div",{className:"flex justify-between items-center font-semibold mb-1 ",title:e.name,children:(0,r.jsx)("span",{className:"truncate ...",style:{display:"block",whiteSpace:"nowrap",width:"90%",overflow:"hidden",textOverflow:"ellipsis",position:"relative"},title:e.name,children:e.name})}),(0,r.jsx)("div",{children:(0,r.jsxs)("button",{className:" rounded-md h-9 pl-2 ".concat(e.loading?"pr-2":"pr-0","  ").concat(e.installed?"btn":"btn-blue"),disabled:e.loading,id:0==t?"SelectModelButton":"",onClick:async()=>{try{var a;let n=[...i],c=e.installed?v.tZ:v.mg;null===(a=b.current)||void 0===a||a.destroy(),(0,d.PQ)(N,"ok"),n[t].loading=!0,p(n);let m=await c(e.id);m.success&&(e.installed=!e.installed,(0,o.ZP)(t=>(0,r.jsx)(s.Z,{iconCheck:!0,children:(0,r.jsx)("div",{className:"ml-3 h6",children:e.installed?"Install ".concat(e.name):"Uninstall ".concat(e.name)})})),l(n.filter(e=>e.installed),e.id)),n[t].loading=!1,p(n)}catch(l){console.error(l,"err");let e=[...i];e[t].loading=!1,p(e)}},children:[e.installed?"Uninstall":"Install",e.loading?(0,r.jsx)("div",{className:"w-5 h-5 svg-mauto flex items-center justify-center ml-2",children:(0,r.jsx)(h.default,{indicator:(0,r.jsx)(g(),{style:{fontSize:24,color:"red"},spin:!0,rev:void 0})})}):e.installed?(0,r.jsx)(x,{className:"w-5 h-5 dark:fill-white"}):(0,r.jsx)(f,{className:"w-5 h-5 dark:fill-white"})]})})]})]}),(0,r.jsxs)("div",{className:"dark:border-transparent  px-3 py-3 text-sm",children:[(0,r.jsxs)("p",{children:["Price:  ","0"!=e.price?"$".concat(e.price,"/use"):"free"]}),(0,r.jsx)("p",{children:e.desc})]})]},t))})})]})};var w=b},57349:function(e,t,l){"use strict";var r=l(67294);let a=r.forwardRef(function({title:e,titleId:t,...l},a){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:a,"aria-labelledby":t},l),e?r.createElement("title",{id:t},e):null,r.createElement("path",{fillRule:"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z",clipRule:"evenodd"}))});t.Z=a}},function(e){e.O(0,[277,5445,1265,1664,5675,437,1098,6455,4833,2554,9411,4749,2891,4305,5362,9120,7703,6896,9774,2888,179],function(){return e(e.s=94309)}),_N_E=e.O()}]);