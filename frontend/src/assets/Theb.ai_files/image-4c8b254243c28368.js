(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8358],{87855:function(e,t,r){"use strict";var l=r(75263).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=l(r(67294)),a=r(38882),s=()=>{let[e,t]=n.useState(!1);return n.useEffect(()=>{t((0,a.detectFlexGapSupported)())},[]),e};t.default=s},38882:function(e,t,r){"use strict";let l;var n=r(64836).default;Object.defineProperty(t,"__esModule",{value:!0}),t.detectFlexGapSupported=t.canUseDocElement=void 0,Object.defineProperty(t,"isStyleSupport",{enumerable:!0,get:function(){return s.isStyleSupport}});var a=n(r(19158)),s=r(3481);let o=()=>(0,a.default)()&&window.document.documentElement;t.canUseDocElement=o;let i=()=>{if(!o())return!1;if(void 0!==l)return l;let e=document.createElement("div");e.style.display="flex",e.style.flexDirection="column",e.style.rowGap="1px",e.appendChild(document.createElement("div")),e.appendChild(document.createElement("div"));let t=document.createElement("div");return t.style.position="absolute",t.style.zIndex="-9999",t.appendChild(e),document.body.appendChild(t),l=1===e.scrollHeight,document.body.removeChild(t),l};t.detectFlexGapSupported=i},98919:function(e,t,r){"use strict";var l=r(75263).default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=l(r(67294)),a=r(11280);let s=e=>{let{className:t,direction:r,index:l,marginDirection:s,children:o,split:i,wrap:c,style:d}=e,{horizontalSize:u,verticalSize:m,latestIndex:p,supportFlexGap:f}=n.useContext(a.SpaceContext),h={};return(!f&&("vertical"===r?l<p&&(h={marginBottom:u/(i?2:1)}):h=Object.assign(Object.assign({},l<p&&{[s]:u/(i?2:1)}),c&&{paddingBottom:m})),null==o)?null:n.createElement(n.Fragment,null,n.createElement("div",{className:t,style:Object.assign(Object.assign({},h),d)},o),l<p&&i&&n.createElement("span",{className:`${t}-split`,style:h},i))};t.default=s},11280:function(e,t,r){"use strict";var l=r(64836).default;Object.defineProperty(t,"__esModule",{value:!0}),t.SpaceContextProvider=t.SpaceContext=void 0;var n=l(r(67294));let a=n.default.createContext({latestIndex:0,horizontalSize:0,verticalSize:0,supportFlexGap:!1});t.SpaceContext=a;let s=a.Provider;t.SpaceContextProvider=s},74048:function(e,t,r){"use strict";var l=r(75263).default,n=r(64836).default;Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"SpaceContext",{enumerable:!0,get:function(){return m.SpaceContext}}),t.default=void 0;var a=n(r(94184)),s=n(r(45598)),o=l(r(67294)),i=n(r(87855)),c=r(31929),d=n(r(46549)),u=n(r(98919)),m=r(11280),p=n(r(54277)),f=function(e,t){var r={};for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&0>t.indexOf(l)&&(r[l]=e[l]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,l=Object.getOwnPropertySymbols(e);n<l.length;n++)0>t.indexOf(l[n])&&Object.prototype.propertyIsEnumerable.call(e,l[n])&&(r[l[n]]=e[l[n]]);return r};let h={small:8,middle:16,large:24},v=o.forwardRef((e,t)=>{var r,l;let{getPrefixCls:n,space:d,direction:v}=o.useContext(c.ConfigContext),{size:g=(null==d?void 0:d.size)||"small",align:x,className:y,rootClassName:w,children:j,direction:b="horizontal",prefixCls:_,split:N,style:S,wrap:E=!1,classNames:C,styles:I}=e,M=f(e,["size","align","className","rootClassName","children","direction","prefixCls","split","style","wrap","classNames","styles"]),k=(0,i.default)(),[O,P]=o.useMemo(()=>(Array.isArray(g)?g:[g,g]).map(e=>"string"==typeof e?h[e]:e||0),[g]),A=(0,s.default)(j,{keepEmpty:!0}),z=void 0===x&&"horizontal"===b?"center":x,Z=n("space",_),[F,R]=(0,p.default)(Z),T=(0,a.default)(Z,null==d?void 0:d.className,R,`${Z}-${b}`,{[`${Z}-rtl`]:"rtl"===v,[`${Z}-align-${z}`]:z},y,w),L=(0,a.default)(`${Z}-item`,null!==(r=null==C?void 0:C.item)&&void 0!==r?r:null===(l=null==d?void 0:d.classNames)||void 0===l?void 0:l.item),H="rtl"===v?"marginLeft":"marginRight",G=0,V=A.map((e,t)=>{var r,l;null!=e&&(G=t);let n=e&&e.key||`${L}-${t}`;return o.createElement(u.default,{className:L,key:n,direction:b,index:t,marginDirection:H,split:N,wrap:E,style:null!==(r=null==I?void 0:I.item)&&void 0!==r?r:null===(l=null==d?void 0:d.styles)||void 0===l?void 0:l.item},e)}),B=o.useMemo(()=>({horizontalSize:O,verticalSize:P,latestIndex:G,supportFlexGap:k}),[O,P,G,k]);if(0===A.length)return null;let D={};return E&&(D.flexWrap="wrap",k||(D.marginBottom=-P)),k&&(D.columnGap=O,D.rowGap=P),F(o.createElement("div",Object.assign({ref:t,className:T,style:Object.assign(Object.assign(Object.assign({},D),null==d?void 0:d.style),S)},M),o.createElement(m.SpaceContextProvider,{value:B},V)))}),g=v;g.Compact=d.default,t.default=g},83740:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/image",function(){return r(19327)}])},74641:function(e,t,r){"use strict";var l=r(85893),n=r(44319),a=r(91633),s=r(74806),o=r(65880),i=r(67294),c=r(45933),d=r(50888),u=r(89552),m=r(94055);let p=e=>{let{index:t,item:r,isChat:p,edit:f,onDeleteChange:h}=e,{filesList:v,setFileList:g}=(0,i.useContext)(o.p),x=!1,y="",w="";if("string"==typeof r){var j=r.split("__").slice(1).join("__");x=["jpg","jpeg","png","gif","bmp","svg"].includes(j.split(".")[1]),w=j,y=r}else{let{file:e}=r,t=e.name,l=t.split(".").pop().toLowerCase();x=["jpg","jpeg","png","gif","bmp","svg"].includes(l);let n=URL.createObjectURL(e);y=n,w=t}return(0,l.jsx)("div",{className:"p-2 border-2  border-n-3 dark:border-n-5 rounded-xl  mt-3 mr-3 ".concat("error"==r.status?" border-red-500 dark:border-red-500":""," ").concat(x?"md:mr-2":"md:w-full md:mr-0"),children:(0,l.jsxs)("div",{className:"flex items-center base1 font-semibold",children:[(0,l.jsxs)("div",{className:"relative flex items-center justify-center rounded-xl overflow-hidden ".concat(x?"":"md:w-full"),children:[(0,l.jsx)("div",{className:" relative w-[48px] h-[48px] dark:bg-n-6 rounded-xl overflow-hidden",children:x?(0,l.jsx)(a.Z,{className:"object-cover rounded-xl",src:y,alt:"Avatar",style:{width:48,height:48,cursor:"pointer"},width:48,height:48,preview:{mask:""}}):(0,l.jsx)("div",{className:"w-[48px] h-[48px] bg-n-9 flex justify-center items-center",children:(0,l.jsx)(c.Z,{className:"w-7 h-7 text-white"})})}),!p&&r.progress<100&&"uploading"==r.status&&(0,l.jsxs)("div",{className:"w-[48px] h-[48px] absolute left-0 flex justify-center items-center rounded-xl overflow-hidden",children:[(0,l.jsx)("div",{className:"mask"}),(0,l.jsx)(s.Z,{type:"circle",strokeColor:"#fff",trailColor:"#999",percent:r.progress,size:40,showInfo:!1})]}),"loading"==r.status&&(0,l.jsxs)("div",{className:"w-[48px] h-[48px] absolute left-0 flex justify-center items-center rounded-xl overflow-hidden",children:[(0,l.jsx)("div",{className:"mask"}),(0,l.jsx)(u.default,{indicator:(0,l.jsx)(d.Z,{style:{fontSize:40,color:"#fff"},spin:!0,rev:void 0})})]}),(!x||p)&&(0,l.jsxs)("div",{className:"overflow-hidden ml-2 flex-1 ",children:[(0,l.jsx)("div",{className:"truncate max-w-[11rem] md:max-w-full",title:w,children:w}),(0,l.jsx)("div",{className:"truncate text-gray-300 text-sm dark:text-gray-500",children:x?"Image":"File"})]})]}),(!p||f)&&(0,l.jsx)(m.default,{placement:"top",title:"Remove file",children:(0,l.jsx)("button",{className:"group w-8 h-8 -mr-2 rounded-full text-0",onClick:()=>{if(f)h();else{let e=[...v];e.splice(t,1),g(e)}},children:(0,l.jsx)(n.Z,{className:"w-5 h-5 fill-n-4 transition-colors group-hover:fill-accent-1 ".concat("error"==r.status?" fill-red-500 dark:fill-red-500":""),name:"trash"})})})]})})};t.Z=p},4638:function(e,t,r){"use strict";var l=r(85893),n=r(67294),a=r(11355),s=r(18968),o=r(66180),i=r(44319);let c=e=>{let{className:t,classWrap:r,classOverlay:c,classButtonClose:d,visible:u,onClose:m,initialFocus:p,children:f,video:h,noMax:v}=e,g=e=>{e.stopPropagation()};return(0,l.jsx)(a.u,{show:u,as:n.Fragment,children:(0,l.jsxs)(s.V,{initialFocus:p,className:"fixed inset-0  z-50 flex p-6 overflow-auto scroll-smooth md:px-4 ".concat(t),onClose:m,children:[(0,l.jsx)(a.u.Child,{as:n.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,l.jsx)("div",{className:"fixed inset-0 ".concat(h?"bg-n-7/95":"bg-n-7/75 dark:bg-n-6/90"," ").concat(c),"aria-hidden":"true"})}),(0,l.jsx)(a.u.Child,{as:n.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 ".concat(!h&&"scale-95"),enterTo:"opacity-100 ".concat(!h&&"scale-100"),leave:"ease-in duration-200",leaveFrom:"opacity-100 ".concat(!h&&"scale-100"),leaveTo:"opacity-0 ".concat(!h&&"scale-95"),children:(0,l.jsxs)(s.V.Panel,{className:(0,o.m)("relative z-10  w-full m-auto bg-n-1 rounded-3xl dark:bg-n-7 ".concat(h&&"static max-w-[64rem] aspect-video rounded-[1.25rem] bg-n-7 overflow-hidden shadow-[0_2.5rem_8rem_rgba(0,0,0,0.5)]"," ").concat(r),"".concat(v?"":"max-w-[65rem] !important")),onClick:g,children:[f,(0,l.jsx)("button",{className:(0,o.m)("text-0 fill-n-7 hover:fill-primary-1 ".concat(h&&"absolute top-6 right-6 w-10 h-10 bg-n-1 rounded-full"," ").concat(d)),onClick:m,children:(0,l.jsx)(i.Z,{className:"fill-inherit transition-colors",name:"close"})})]})})]})})};t.Z=c},19327:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return J}});var l=r(85893),n=r(67294),a=r(55281),s=r(74806),o=r(4638),i=r(25675),c=r.n(i),d=r(31889),u=r(635),m=r(9473),p=r(7938),f=r(4869),h=r(62161),v=r(65880),g=r(23330),x=r(6154);let y=function(e){e||(e={}),this.timeConstant=e.timeConstant||1e3,this.progress=0,this._running=!1,this._intervalFrequency=100,this.autoStart=e.autoStart||!1,this.parent=e.parent,this.parentStart=e.parentStart,this.parentEnd=e.parentEnd,this.autoStart&&this.start()};y.prototype.start=function(){this._time=0,this._intervalId=setInterval(this._onInterval.bind(this),this._intervalFrequency)},y.prototype._onInterval=function(){this._time+=this._intervalFrequency,this.setProgress(1-Math.exp(-1*this._time/this.timeConstant))},y.prototype.end=function(){this.stop(),this.setProgress(1)},y.prototype.stop=function(){clearInterval(this._intervalId),this._intervalId=null},y.prototype.createSubProgress=function(e){let t=e.start||this.progress,r=e.end||1,l=Object.assign({},e,{parent:this,parentStart:t,parentEnd:r,start:null,end:null}),n=new y(l);return n},y.prototype.setProgress=function(e){this.progress=e,this.parent&&this.parent.setProgress((this.parentEnd-this.parentStart)*this.progress+this.parentStart)};var w=r(74048),j=r(91633),b=r(97460),_={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M505.7 661a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V168c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"download",theme:"outlined"},N=r(55230),S=n.forwardRef(function(e,t){return n.createElement(N.Z,(0,b.Z)({},e,{ref:t,icon:_}))}),E={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"}}]},name:"zoom-out",theme:"outlined"},C=n.forwardRef(function(e,t){return n.createElement(N.Z,(0,b.Z)({},e,{ref:t,icon:E}))}),I={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"}}]},name:"zoom-in",theme:"outlined"},M=n.forwardRef(function(e,t){return n.createElement(N.Z,(0,b.Z)({},e,{ref:t,icon:I}))});let k=e=>{let{imageItems:t,imageInfo:r,imagesAboutInfo:n}=e,a=e=>{x.Z.get(e,{responseType:"blob"}).then(e=>{let t=URL.createObjectURL(new Blob([e.data])),r=document.createElement("a");r.href=t,r.download="image.jpg",document.body.appendChild(r),r.click(),URL.revokeObjectURL(t),r.remove()}).catch(e=>{console.error("Error occurred:",e)})};return(0,l.jsx)(j.Z.PreviewGroup,{preview:{onChange:(e,t)=>console.log("current index: ".concat(e,", prev index: ").concat(t)),onVisibleChange:e=>{console.log(e,"value");let t=window.Ybug;e&&t?t.hide():!e&&t&&t.show()},toolbarRender:(e,r)=>{let{transform:{scale:n},actions:{onZoomOut:s,onZoomIn:o},current:i}=r;return(0,l.jsxs)(w.default,{size:12,className:"toolbar-wrapper",children:[(0,l.jsx)(S,{onClick:()=>a(t[i]),rev:void 0}),(0,l.jsx)(C,{disabled:1===n,onClick:s,rev:void 0}),(0,l.jsx)(M,{disabled:50===n,onClick:o,rev:void 0})]})}},children:t&&t.map((e,r)=>(0,l.jsx)(j.Z,{width:1==t.length?256:"100%",src:e,alt:n.title,className:" bg-slate-300"},r))})},O=e=>{let{title:t,children:r}=e,{chat:{imagesStatus:n,imagesAboutInfo:a},imagesModel:{imagesChatModelParams:s}}=(0,m.v9)(e=>e);return(0,l.jsxs)(l.Fragment,{children:[(t||"new_chat"!=n)&&(0,l.jsxs)("div",{className:"flex items-center min-h-[4.5rem] md:min-h-[3.5rem] px-10 py-3 border-b border-n-3 shadow-[0_0.75rem_2.5rem_-0.75rem_rgba(0,0,0,0.06)] 2xl:px-6  lg:pr-20 md:pl-5 md:pr-18 dark:border-n-5 dark:shadow-[0_0.75rem_2.5rem_-0.75rem_rgba(0,0,0,0.15)] relative z-10",children:[(0,l.jsx)("div",{className:"mr-auto h5 truncate md:h6 flex-1",title:t||"New Images",children:t||"New Images"}),(0,l.jsx)("div",{className:"flex relative items-center pl-6 md:pr-0 ",children:"dialogue"===n&&(0,l.jsxs)("div",{className:" text-gray-400 font-semibold pr-2",children:["Model:",(e=>{var t;let{model:r}=e;return null===(t=s.find(e=>e.model_id===r))||void 0===t?void 0:t.model_name})(a)]})})]}),(0,l.jsx)("div",{className:"relative z-2 grow p-0 space-y-10 overflow-y-auto scroll-smooth scrollbar-none md:p-5",id:"grid-sw-height",children:r})]})};var P=r(1852),A=r(96486),z=r.n(A);let Z=()=>{let[e,t]=(0,n.useState)([]),r=(0,n.useRef)(!1),l=(0,m.I0)(),{imagesModelData:a,userSelectionImagesModel:s}=(0,m.v9)(e=>e.imagesModel);return(0,n.useEffect)(()=>{let e=async()=>{try{let e=await(0,f.wX)();if(e.success){let r=e.data;if(t(r),r.length>0){if(s){let e=r.find(e=>e.model_id===a.model_id);console.log(r,"datadata"),console.log(e,"defaultModel"),e?(l((0,u.vA)(!0)),l((0,u.sM)(e))):(l((0,u.vA)(!0)),l((0,u.sM)(r[0])))}else l((0,u.vA)(!0)),l((0,u.sM)(r[0]));l((0,u.ql)(r))}}}catch(e){console.log(e,"error")}};r.current||(r.current=!0,e())},[]),{models:e}};var F=r(50733);let R=e=>{let{driverRef:t,jsonTips:r,json:l,isMobile:a,browserLanguage:s,isModelDialogOpen:o}=e,{visibleSidebar:i,visibleRightSidebar:c,setVisibleRightSidebar:d,setRightHistoryTips:u}=(0,n.useContext)(v.p),m="IMAGES_TIPS";(0,n.useEffect)(()=>{let e=(0,F.bh)(m);if(console.log(e,"getStepsIndex"),console.log(c,"visibleRightSidebar"),l&&r&&"ok"!=e&&(!a||+e>1&&a||c)){let e=()=>{(0,F.PQ)(m,"ok"),setTimeout(()=>{u(3)},100)},l=(0,F.zm)({steps:[{element:"#AI_Image",popover:{title:r.image_desc.title[s],description:r.image_desc.description[s]}},{element:"#PRICE",popover:{title:r.price.title[s],description:r.price.description[s]}},{element:"#SelectModel",popover:{title:r.selectModel.title[s],description:r.selectModel.description[s]}},{element:"#INPUT",popover:{title:r.image_input.title[s],description:r.image_input.description[s]}}],onPrev(){1==l.getState().activeIndex&&a&&(console.log("setVisibleRightSidebar true"),d(!0)),(0,F.PQ)(m,l.getState().activeIndex-1)},onNext(){1==l.getState().activeIndex&&a&&(console.log("setVisibleRightSidebar false"),d(!1)),(0,F.PQ)(m,l.getState().activeIndex)},onComplete(){console.log("complete"),e()}});t.current=l;let n=(0,F.bh)(m);!o&&(+n>1&&a&&c||l.drive(n?+n:0))}},[l,r,o,a,c,s,i,u,d,t])};var T=r(94055),L=r(44319),H=r(11119);let G=e=>{let{IMAGES_TIPS:t,driverRef:r,json:n,setIsModelDialogOpen:a}=e,{imagesModel:{imagesModelData:s,userSelectionImagesModel:o},language:{browserLanguage:i}}=(0,m.v9)(e=>e),c=e=>{if(e){let t=[];return Object.keys(e).map(r=>{t.push((0,l.jsx)("p",{dangerouslySetInnerHTML:{__html:"".concat(r,": ").concat(e[r])}},r))}),t}};return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("div",{className:"absolute w-[90%] flex justify-center items-center flex-col ",style:{top:0,left:"50%",height:"calc(100% - 5rem)",marginLeft:"-45%"},children:(0,l.jsxs)("div",{className:"mb-10 text-center w-full",children:[(0,l.jsx)("div",{className:"h3 leading-[4rem] 2xl:mb-2 2xl:h4 flex items-center relative h-12 ",children:(0,l.jsx)(T.default,{placement:"top",overlayClassName:"oc-300 sm:oc-none",title:()=>(0,l.jsxs)("div",{className:"p-2 markdown",children:[s.model_name,c(null==s?void 0:s.meta)]}),children:(0,l.jsxs)("div",{className:"flex items-center justify-center ",id:"PRICE",style:{position:"absolute",left:"50%",transform:"translateX(var(--offset))"},children:[o?s.model_name:"Image",(0,l.jsx)("div",{className:"ml-1",children:(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"w-6 h-6 text-gray-500",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"})})})]})})}),(0,l.jsx)("div",{className:"body1 text-n-4 2xl:bodyS mt-2",children:(0,l.jsx)("div",{className:"body1 text-n-4 2xl:bodyS mt-2",children:n&&n.IMAGE_TITTLE[i]})}),(0,l.jsxs)("button",{id:"SelectModel",className:"btn-dark btn-medium mt-2",onClick:()=>{let e=(0,F.bh)(t);"ok"!=e&&2==+e&&(r.current&&r.current.destroy(),(0,F.PQ)(t,3)),a(!0)},children:[(0,l.jsx)(L.Z,{className:"inline-block w-[1rem!important] h-[1rem!important] fill-n-4 transition-colors group-hover:fill-primary-1 ml-[0!important]",name:"container"}),H.CHAT_SELECT_MODEL[i]||H.CHAT_SELECT_MODEL.en]})]})})})};var V=r(68709);let B=(0,n.lazy)(()=>r.e(758).then(r.bind(r,40758))),D=x.Z.CancelToken.source(),U=()=>{let[e,t]=(0,n.useState)({w:0,h:0}),[r,a]=(0,n.useState)([]),[i,x]=(0,n.useState)(!1),[w,j]=(0,n.useState)(!1),[b,_]=(0,n.useState)(!1),{setVisibleRightSidebar:N}=(0,n.useContext)(v.p),[S,E]=(0,n.useState)(!1),[C,I]=(0,n.useState)(0),M=(0,n.useRef)(null),A=(0,n.useRef)(null),F=(0,n.useRef)(null),T=(0,m.I0)(),{chat:{imagesStatus:L,imagesAboutInfo:H,historyList:U,selectChatHistory:$},imagesModel:{imagesModelData:q,imagesChatModelParams:Q},language:{browserLanguage:W}}=(0,m.v9)(e=>e),{userInfo:{globalOrgId:X},config:{mode:K}}=(0,m.v9)(e=>e),[Y,J]=(0,n.useState)(1),{models:ee}=Z(),{json:et,jsonTips:er}=(0,V.Z)(),el=(0,P.useMediaQuery)({query:"(max-width: 769px)"});R({driverRef:A,json:et,jsonTips:er,isMobile:el,browserLanguage:W,isModelDialogOpen:S});let en=()=>{x(!0);let e=new y({timeConstant:6e4,autoStart:!0});F.current=setInterval(function(){I(parseFloat((100*e.progress).toFixed(1))),console.log("Progress is "+(100*e.progress).toFixed(1)+" %")},1e3),M.current=function(){e.end(),I(100),setTimeout(()=>{x(!1)},500),F.current&&clearInterval(F.current),console.log("Ended. Progress is "+(100*e.progress).toFixed(1)+" %"),M.current=null}},ea=e=>{let r=Object.values(e);a(r.map(e=>e.url)),(0,g.ek)(r[0].url,(e,r)=>{t({w:e,h:r})})},es=(e,r)=>{console.log("source:",e),F.current&&clearInterval(F.current),M.current&&M.current(),x(!1),j(!1),I(0),a([]),t({w:0,h:0}),r&&r()},eo=async e=>{try{en();let t=await(0,f.sK)(e);if(t.success){let{images:e,params:r,params_def:l}=t.data;Object.values(e).length>0&&ea(e),t.data.params_def=(0,g.u_)(r,l),T((0,h.N_)(t.data)),M.current&&M.current()}else M.current&&M.current()}catch(e){M.current&&M.current()}},ei=async e=>{if(A.current&&A.current.destroy(),""!==e.trim()){let t=Q.find(e=>e.model_id===q.model_id),r={};(0,g.hu)(t.paramsAction.length>0,"未找到相应的模型配置"),t.paramsAction&&t.paramsAction.map(e=>{r[e.name]=e.default}),H.id&&(r=H.params);try{console.log(L,"imagesStatus"),T((0,h.VH)({id:"",title:e,newItem:!1})),"new_chat"===L&&T((0,h.N_)({id:"",title:e,model:t.model_id,params:{},params_def:[],created_at:"",user_message:"",images:{}})),H.id&&e!=H.title&&T((0,h.N_)({...H,title:e})),T((0,h.Hr)({page:K,status:"responding"})),es("send message"),en(),console.log(C,"percent"),console.log(i,"showProgress");let l=await(0,f.Fs)(X,{text:e,model:t.model_id,model_params:r},D.token,{"x-ai-model":t.model_id});if(l.data){M.current&&M.current();let{images:e,id:t,params:r,params_def:n,title:a}=l.data;Object.values(e).length>0&&ea(e);let s={id:t,title:a,newItem:!0},o=z().cloneDeep(U);o.unshift({...s,...l.data}),l.data.params_def=(0,g.u_)(r,n),T((0,h.vK)(o)),T((0,h.N_)(l.data)),T((0,h.VH)(s)),setTimeout(()=>{T((0,h.Hr)({page:K,status:"dialogue"}))},500)}console.log(l,"resres")}catch(e){console.log(e,"error"),es("error send message"),T((0,h.Hr)({page:K,status:"new_chat"})),T((0,h.N_)({id:"",title:"New Images Error",model:t.model_id,params:{},params_def:[],created_at:"",user_message:"",images:{}}))}}};return(0,n.useEffect)(()=>{$&&$.id&&$.id!=H.id&&(console.log("切换新的聊天记录"),es("selectChatHistory.id"),eo($.id))},[$]),(0,n.useEffect)(()=>{"new_chat"==L&&M.current&&(console.log("new_chat imagesStatus"),M.current())},[L]),(0,n.useEffect)(()=>()=>{console.log("页面卸载了"),M.current&&M.current(),F.current&&clearInterval(F.current)},[]),(0,n.useEffect)(()=>{if("dialogue"==L){let e=new ResizeObserver(e=>{for(let l of e){var t;let e=l.target.offsetWidth,n=l.target.offsetHeight,a=null===(t=document.getElementById("grid-sw-height"))||void 0===t?void 0:t.offsetHeight;n>a&&!b?(console.log("里面的内容超过原始高度了"),_(!0)):n<a&&b&&(console.log("里面的内容没超过原始高度了"),_(!1)),console.log(e/(235*r.length),"newWidth / (imageItems.length * 235)"),e/(235*r.length)<=1&&!w?(console.log("写入autoFill true"),j(!0)):e/(235*r.length)>=1&&w&&(console.log("写入autoFill false"),j(!1)),console.log("图片内容的高度为: ".concat(a,"px")),console.log("Div的宽度变为: ".concat(e,"px")),console.log("Div的高度变为: ".concat(n,"px"))}}),t=document.querySelector("#grid-sw-width");return t&&e.observe(t),()=>{e.disconnect()}}},[L,w,r.length,b]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(O,{title:H.title,children:(0,l.jsxs)("div",{className:"grow px-10 overflow-y-auto scroll-smooth scrollbar-none md:px-4 py-6 flex items-center justify-center ".concat(b?"h-auto":"h-full"," md:py-0  "),children:["responding"===L&&(0,l.jsxs)("div",{className:"absolute w-[90%] flex justify-center items-center flex-col ",style:{top:0,left:"50%",height:"calc(100% - 5rem)",marginLeft:"-45%"},children:[(0,l.jsx)("div",{className:"text-center",children:(0,l.jsxs)("div",{style:{fontWeight:"600",fontSize:"1.125rem",color:"gray"},children:["Model:",(e=>{var t;let{model:r}=e;return null===(t=Q.find(e=>e.model_id===r))||void 0===t?void 0:t.model_name})(H)]})}),(0,l.jsx)("div",{className:"w-full h-2 relative mt-4",children:101!=C&&i&&(0,l.jsx)(s.Z,{percent:C,strokeColor:{"0%":"#108ee9","100%":"#87d068"},showInfo:!1})})]}),"new_chat"===L&&et&&(0,l.jsx)(G,{driverRef:A,IMAGES_TIPS:"IMAGES_TIPS",json:et,setIsModelDialogOpen:E}),"dialogue"===L&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{id:"grid-sw-width",className:"flex justify-center items-center  ant-image-sws md:ant-image-swsw",style:{gridTemplateColumns:"repeat(".concat(r.length>5||w?"auto-fill":r.length,", 235px)")},children:(0,l.jsx)(k,{imageItems:r,imageInfo:e,imagesAboutInfo:H})}),"New Images Error"===H.title&&(0,l.jsxs)("div",{className:"flex justify-center flex-col items-center",children:[(0,l.jsx)(c(),{src:"/images/img_err.svg",alt:"",width:200,height:200}),(0,l.jsx)("span",{className:"text-n-4",children:"Generation failed, please try again"})]})]})]})}),(0,l.jsx)(d.Z,{value:H.id?H.title:null,handleSendMessage:e=>ei(e),setRefresh:e=>J(e),refresh:Y,status:L,placeholder:(0,g.VQ)("IMAGE_INPUT_MESSAGE",W),domId:"INPUT"}),(0,l.jsx)(o.Z,{className:"md:!p-0",classWrap:"w-[86vw] md:min-h-screen-ios md:rounded-none 2xl:h-[44rem] md:h-auto  md:w-auto",classButtonClose:"block absolute top-5 right-5 dark:fill-n-4",classOverlay:"md:bg-n-1",visible:S,onClose:()=>E(!1),noMax:!0,children:(0,l.jsx)(n.Suspense,{fallback:(0,l.jsx)(p.Z,{}),children:(0,l.jsx)(B,{models:ee,onClose:e=>{T((0,u.sM)(e)),T((0,u.vA)(!0)),E(!1),N(!1)}})})})]})};var $=r(26565),q=r(90214),Q=r(20947),W=r(86892),X=r(41478);let K=()=>{let[e,t]=(0,n.useState)(),[r,s]=(0,n.useState)(!0),o=(0,m.I0)();(0,Q.Z)(),(0,W.Z)(()=>{o((0,X.PM)("images")),o((0,h.VH)({title:"New Chat",id:"",newItem:!1}))});let{userInfo:i}=(0,m.v9)(e=>e);return(0,n.useEffect)(()=>{let e=i.meData;e&&(t(e),s(!1))},[i]),(0,q.Z)(),(0,l.jsxs)(l.Fragment,{children:[r&&(0,l.jsx)(p.Z,{}),e&&(0,l.jsx)($.H,{children:(0,l.jsx)(a.Z,{rightSidebarMode:"images",children:(0,l.jsx)(U,{})})})]})},Y=()=>(0,l.jsx)(K,{});var J=Y},3481:function(e,t,r){"use strict";var l=r(64836).default;Object.defineProperty(t,"__esModule",{value:!0}),t.isStyleSupport=function(e,t){return Array.isArray(e)||void 0===t?a(e):s(e,t)};var n=l(r(19158)),a=function(e){if((0,n.default)()&&window.document.documentElement){var t=Array.isArray(e)?e:[e],r=window.document.documentElement;return t.some(function(e){return e in r.style})}return!1},s=function(e,t){if(!a(e))return!1;var r=document.createElement("div"),l=r.style[e];return r.style[e]=t,r.style[e]!==l}},87337:function(e,t,r){"use strict";r.d(t,{LX:function(){return n},Gr:function(){return a}});var l=r(67294),n=(e,t,r,n)=>{let a=(0,l.useMemo)(()=>{let e=[];return Array.isArray(t)&&(e=[...e,...t]),Array.isArray(r)&&(e=[...e,...r]),Array.isArray(n)&&(e=[...e,...n]),e},[n,t,r]);return(0,l.useEffect)(()=>((async()=>{try{await e()}catch(e){"function"==typeof r?r(e):console.info(e)}})(),()=>{"function"==typeof t&&t()}),a)},a=(e,t,r)=>{let n=(0,l.useMemo)(()=>{let e=[];return Array.isArray(t)&&(e=[...e,...t]),Array.isArray(r)&&(e=[...e,...r]),e},[t,r]);return(0,l.useMemo)(()=>async(...r)=>{try{return await e(...r)}catch(e){"function"==typeof t?t(e):console.error("useMemo",e)}},n)}},62885:function(e,t,r){"use strict";var l=r(67294);let n=l.forwardRef(function({title:e,titleId:t,...r},n){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:n,"aria-labelledby":t},r),e?l.createElement("title",{id:t},e):null,l.createElement("path",{d:"M8.25 4.5a3.75 3.75 0 117.5 0v8.25a3.75 3.75 0 11-7.5 0V4.5z"}),l.createElement("path",{d:"M6 10.5a.75.75 0 01.75.75v1.5a5.25 5.25 0 1010.5 0v-1.5a.75.75 0 011.5 0v1.5a6.751 6.751 0 01-6 6.709v2.291h3a.75.75 0 010 1.5h-7.5a.75.75 0 010-1.5h3v-2.291a6.751 6.751 0 01-6-6.709v-1.5A.75.75 0 016 10.5z"}))});t.Z=n},71221:function(e,t,r){"use strict";var l=r(67294);let n=l.forwardRef(function({title:e,titleId:t,...r},n){return l.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",ref:n,"aria-labelledby":t},r),e?l.createElement("title",{id:t},e):null,l.createElement("path",{fillRule:"evenodd",d:"M4.5 7.5a3 3 0 013-3h9a3 3 0 013 3v9a3 3 0 01-3 3h-9a3 3 0 01-3-3v-9z",clipRule:"evenodd"}))});t.Z=n}},function(e){e.O(0,[277,1664,5675,437,1098,6455,5362,7703,9774,2888,179],function(){return e(e.s=83740)}),_N_E=e.O()}]);